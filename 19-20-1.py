import sys
import collections
r = open('19-20.txt').read().split('\n')

# Used Floodfill algorithm, (aka Breadth first search)

def printgn(w,n):
 for li in range(len(w)):
  s = ''
  for c in range(len(w[li])):
    ch = w[li][c]
    if ch == '.':
      ch = '_'
      r = (li,c)
      if r in l:
        ch = l[r][0]
      if n[li][c] != 0:
        ch = str(n[li][c]%10)
    s += ch
  print('# ',s)


def findl(r):
   l = {}
   sz = len(r)
   st = end = (0,0)
   uc = 'QWERTYUIOPASDFGHJKLZXCVBNM'
   d = [[0,1],[sz,sz-1,sz-2]]
   m = 35
   line = ''
   for i in range(sz):

     if True:      
      if r[i][0]:
         s = r[i][0] + r[i][1]
         p = (i,2)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
      if r[0][i]:
         s = r[0][i] + r[1][i]
         p = (2,i)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
      if r[sz-1][i]:
         s = r[sz-2][i] + r[sz-1][i]
         p = (sz-3,i)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
      if r[i][sz+4]:
         s = r[i][sz+4] + r[i][sz+5]
         p = (i,sz+3)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s 
     if (i > m) and (i < sz-m):
       if r[i][2+sz-m]:
         s = r[i][2+sz-m] + r[i][3+sz-m]
         p = (i,4+sz-m)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
       if r[sz-m+1][i]:
         s = r[sz-m-4][i] + r[sz-m-3][i]
         p = (sz-m-2,i)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
       if r[m-1][i]:
         s = r[m+2][i] + r[m+3][i]
         p = (m+1,i)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s
       if r[i][m-1]:
         s = r[i][m+2] + r[i][m+3]
         p = (i,m+1)
         st,end = se(s,p,st,end)
         if s[0] in uc: l[p] = s 

   return l,st,end

def se(s,p,st,end):
    #print(s)
    if s == 'AA':
        st = p
    if s == 'ZZ': end = p
    return(st,end)

def deadends(w):
    n = [[a[:] for a in g] for g in w]
    szx = len(w)
    szy = len(w[0])    
    done = False
    line = ''    
    m = [[0,1],[0,-1],[1,0],[-1,0]]
    while not done:
      done = True
      for x in range(szx-1):        
        for y in range(szy-1):
          ct = 0
          if n[x][y] == '.':
           ct = 0
           for d in m:
            tx,ty = x+d[0],y+d[1]
            if n[tx][ty] == '#':
              ct += 1
           if ct == 3:
            n[x][y] = '#'
            done = False
    return n

def inrange(x,y,sz):
    if (x > 0) and (x < sz) and (y > 0) and (y < sz):
        return True
    return False


szx = len(r[0])
szy = len(r)

r = deadends(r)
l,st,end = findl(r)

done = False
m = [[0,1],[0,-1],[1,0],[-1,0]]
depth = 1
codef = False
n = [[0 for a in g] for g in r]
n[st[0]][st[1]] = 1

while not done:        
    for x in range(1,szy):
      for y in range(1,szx):
        if n[x][y] == depth:
          for s in [0,1,2,3]:        
             if r[x+m[s][0]][y+m[s][1]] == '.':
              if n[x+m[s][0]][y+m[s][1]] == 0:
                 n[x+m[s][0]][y+m[s][1]] = depth+1
          if (x,y) in l:            
            code = l[(x,y)]
            if code == 'ZZ':
                print ('part 1 - ',depth-1)
                done = True
                printgn(r,n)
            for a in l:          
              if code == l[a]:
                if a != (x,y):
                     n[a[0]][a[1]] = depth+1


    depth += 1

# part 1 -  666
#                                         V         J       Y     B   Z       B   G       M                                             
#                                         A         Z       B     D   Z       S   T       L                                             
#    #####################################7#########7#######6#####7###7#######6###7#######M###########################################  
#    #####################################6789012###456###109#####23456#######7###4#######___#########################################  
#    ###########################################3#####7###2#######3###########6###3#########_#########################################  
#    #####################################0987654#####8###34567###456#########5###210#######_#########################################  
#    #####################################1###########9#######8#####7#########4#####9#######_#########################################  
#    #####################################2#######43210#######901#___#########3#####87654#___#########################################  
#    #####################################3#######5#############2#_###########2#########3#_###########################################  
#    #####################################4#######6#########76543#___#########109#######2#_765432#####################################  
#    #####################################5#######7#########8#######_###########8#######1#######1#####################################  
#    #####################################678#####8#########9#######___#########7#######0#4567890#####################################  
#    #######################################9#####9#########0#########_#########6#######9#3###########################################  
#    #######################################0#####0#########1#########___#######5#######8#2#65432#####################################  
#    #######################################1#####1#########2###########_#######4#######7#1#7###1#####################################  
#    #######################################234###2#######543#######_____#7890123#####456#098#890#####################################  
#    #########################################5###3#######6#########_#####6###########3#######7#######################################  
#    #######################################876###4#######7#######___#####5###########210###456#######################################  
#    #######################################9#####5#######8#######_#######4#############9###3#########################################  
#    #####################################210#####6#######9#######_#######3#############8#012#########################################  
#    #####################################3#######7#######0#######_#######2#############7#9###########################################  
#    #####################################456#####890#678#1#######___#####1#############6#87654#######################################  
#    #######################################7#######1#5#9#2#########_#####0#############5#####3#######################################  
#    #######################################8#######234#0#3#######___#####9#############4#456#2#######################################  
#    #######################################9###########1#4#######_#######8#############3#3#7#1#######################################  
#    #######################################0#678#######2#5#######_#######7#########456#2#2#890#######################################  
#    #######################################1#5#9#######3#6#######_#######6#########3#7#1#1###########################################  
#    #######################################234#0#######4#7#345###_#######5#########2#890#0###########################################  
#    ###########################################1#######5#8#2#6###_#######4#########1#####9###########################################  
#    ###########################################2#####876#901#7###_#######3#########098###8###########################################  
#    ###########################################3#####9#######8###_#######2###########7###7###########################################  
#    ###########################################4#####012#32109###_#######109#######456###6###########################################  
#    ###########################################5#######3#4#######_#########8#######3#####5###########################################  
#    #########################################876#######4#567#####_#######567#######2#####432#########################################  
#    #########################################9#########5###8#####_#######4#########1#######1#########################################  
#    #######################################210#######876#109#####___#####32109###890#######0#########################################  
#    #######################################7#########7###8#########K#########6###7#########7#########################################  
#    ###################################    P         H   J         K         X   J         C      ###################################  
#    ###################################    Q         C   Z         G         Z   I         R      ###################################  
#    ###################################                                                           ###################################  
#    ###################################                                                           ###################################  
#    #098###############################                                                         VA83###321098765###76543#############  
#    #1#7###############################                                                           #2###4#######4###8###2#############  
#    #2#6#######654#####################                                                           #109#5#######32109###1#543#########  
#    #3#5#######7#3#####################                                                           ###8#6###############0#6#2#########  
#    #4#4###654#8#2#####################                                                           #567#7###############987#1098765436AH
#    #5#3###7#3#9#1#####################                                                           #4###8#############################  
#  CK76#21098#210#0987654321098765432107BS                                                         #32109#############################  
#    ###################################                                                           ###################################  
#    #######0123456#456789012345678#####                                                           #098###21098#210987654#############  
#    #######9#####7#3#############9#####                                                           #1#7###3###7#3#######3#############  
#  UB72#45678###098#2#############012347DX                                                         #2#654#4###654#######210987654#####  
#    #3#3#######1###1###################                                                           #3###3#5#####################3#####  
#    #4#2109876#234#0###################                                                           #4###2#6#####################2#####  
#    #5#######5###5#9###################                                                           #5###1#7#####################1#####  
#    #678901234###678###################                                                         YB76###098#####################098767CB
#    ###################################                                                           ###################################  
#    ###################654#876#####0987NU                                                         #######23456#######################  
#    ###################7#3#9#5#####1###                                                           #######1###7#######################  
#    ###################8#210#4#####2###                                                           #####890###8#######################  
#    ###################9#####3#####3###                                                           #####7#####9#######################  
#    #################210###012#####456#                                                           #####65432#012###################67NK
#    #################3#####9#########7#                                                           #########1###3###################5#  
#  KE709876543210987654#####87654321098#                                                         SG7234567890###456789012345678901234#  
#    ###################################                                                           ###################################  
#    ###################_________#_____#                                                           ###___#######___###_______#########  
#    ###################_#######_#_###_#                                                           ###_#_#######_#_###_#####_#########  
#    #############___###_______#_#___#_#                                                           ###_#___#_____#_____#####_#___#####  
#    #############_#_#########_#_###_#_#                                                           ###_###_#_###############_#_#_#####  
#    #########_____#_#####_____#_____#_MML                                                         #___###___###############___#_###_GGS
#    #########_#####_#####_#############                                                           #_###########################_###_#  
#  SRS_________#####_______#############                                                         WIW_###########################_____#  
#    ###################################                                                           ###################################  
#  XZ76789012###########################                                                           #############234#######678901234###  
#    #5#####3###########################                                                           #############1#5#######5#######5###  
#    #432###4###########################                                                         GE701234###67890#678901234#######6###  
#    ###1###5###########################                                                           #####5###5#####################7###  
#    ###098#678###############89012###07AH                                                         #####6#234#####################8907RR
#    #####7###9###############7###3###9#                                                           #####7#1###########################  
#  AA123456###01234567890123456###45678#                                                           #####890###########################  
#    ###################################                                                           ###################################  
#    #########76543#7654321#########987#                                                           #_________#########################  
#    #########8###2#8#####0#########0#6#                                                           #_#######_#########################  
#    #765432109###109#####9876543#321#5#                                                           #___#####_#####################___#  
#    #8#########################2#4###4#                                                           ###_#####_#####################_#_#  
#  SG69#########################1#5###36RR                                                       GSG_#_#####___###########_________#_KKG
#    ###########################0#6#####                                                           #_#_#######_###########_###########  
#    ###########################987#####                                                           #___#######_____________###########  
#    ###################################        S     B   C       G U           C K           N    ###################################  
#    ###################################        R     D   B       T B           K E           K    ###################################  
#    ###########################################S#####8###6#######6#6###########6#6###########6#######################################  
#    #######################################_____#56789###3#765###789#567#5432109#3#901#######901#####################################  
#    #######################################_#####4#######2#8#4#####0#4#6#6#######4#8#2#########2#####################################  
#    #####################################___#####321#####109#321###123#5#7890123#567#345#9876543#####################################  
#    #####################################_#########0###########0#######4#######4#######6#0###########################################  
#    #####################################_#########987###90123#9#####123#######5#987#987#1###########################################  
#    #####################################_###########6###8###4#8#####0#########6#0#6#0###2###########################################  
#    #####################################_###########5###765#567#####9#####543#7#1#5#123#3456789#####################################  
#    #####################################_###########4#####4#########8#####6#2#8#2#4###4#######0#####################################  
#    #####################################_#######90123#####321#######765#987#109#3#321#5#######1#####################################  
#    #####################################_#######8###########0#########4#0#######4###0#6#######2#####################################  
#    #####################################_#######7654321#####987###90123#1#######567#987#######3#####################################  
#    #####################################_#############0#######6###8#####2#########8###########4#####################################  
#    #####################################_#######3456789#######5###7#####345#######9###########5#####################################  
#    #####################################_#######2#############4###6#######6#######0###########6#####################################  
#    #####################################_#######1#############3#345#####987#####321#########987#####################################  
#    #####################################_#######0#############2#2#######0#######4###########0#######################################  
#    #####################################_#######9#############1#1#######1#######5###########123#####################################  
#    #####################################_#######8#############0#0#######2#######6#############4#####################################  
#    #####################################___#####7#############9#9#######3#######7###########765#####################################  
#    #######################################_#####6#############8#8#######4#######8###########8#######################################  
#    #######################################_____#5#############7#7#######5#######9#########109#######################################  
#    ###########################################_#4#############6#6#######6#######0#########2#########################################  
#    #####################################___#___#3#############5#5###765#7#######123#####543#########################################  
#    #####################################_#_#_###2#############4#4###8#4#8#########4#####6###########################################  
#    #####################################_#_#___#10987#######123#32109#3#9#######765#####78901#######################################  
#    #####################################_#_###_#####6#######0#########2#0#######8###########2#######################################  
#    #####################################_#_____#####543#####9#####78901#1#######9#######543#3#######################################  
#    #####################################_#############2#####8#####6#####2#######0#######6#2#4#######################################  
#    #####################################_____#########1#####7#####5#109#3#######1#######7#1#5#######################################  
#    #########################################_#########0#####6#####4#2#8#4#######2#######8#0#6#######################################  
#    #########################################_#######789#####543#123#3#7#5#123###345#####9#987#######################################  
#    #########################################_#######6#########2#0###4#6#6#0#4#####6#####0###########################################  
#    #########################################___#12345#####78901#98765#5#789#5#####7#####1234567#####################################  
#    ###########################################W#6#########6#########6#6#####6#####6###########6#####################################  
#                                               W H         D         N P     J     G           C                                       
#                                               I C         X         U Q     I     E           R                                       
